% kappa.tex
% ----------------------------------------------------------------------

% Base class and packages
\documentclass{article}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{lineno}
\usepackage{natbib}
\usepackage[onehalfspacing]{setspace}
\usepackage{physics}
\usepackage[colorlinks, citecolor=blue]{hyperref}
%\usepackage{graphicx}

% My commands
%\newcommand{\note}[1]{\textbf{[NOTE: #1]}}
%\newcommand{\todo}[1]{\emph{[\textbf{Todo:} #1]}}
%\newcommand{\aref}[0]{\textbf{[ref.]}}
\renewcommand{\div}[1]{\mathrm{div}\,#1}
\renewcommand{\grad}[1]{\vec{\mathrm{grad}}\,#1}
\newcommand{\tensdiv}[1]{\vec{\mathrm{div}}\,#1}
\newcommand{\tensgrad}[1]{\bm{\mathrm{grad}}\,#1}

% Internal references
\newcommand{\eqn}[1]{Eqn.~\ref{eqn:#1}}
\newcommand{\fig}[1]{Fig.~\ref{fig:#1}}
\newcommand{\tab}[1]{Table~\ref{tab:#1}}

% Document properties
\title{Numerical simulation of the Cordilleran ice sheet \\
       through the last glacial cycle}
\author{Julien Seguinot}

% ----------------------------------------------------------------------
\begin{document}
% ----------------------------------------------------------------------

\maketitle
\linenumbers

% ----------------------------------------------------------------------
\section{Introduction}
\label{sec:intro}
% ----------------------------------------------------------------------
% Ice as viscous matter
% Glaciers and ice sheets
% The last glacial cycle

% Fig. crevasses
% Fig. glacier flowing
% Fig. recent climate evolution
% Fig. present and palaeo-ice sheets

% ----------------------------------------------------------------------
\section{Field area description}
% ----------------------------------------------------------------------
% Geographic setting
% Climatic setting
% Palaeo-glaciology

% Fig. map of North America
% Fig. map of the Cordillera?
% Fig. photos of the Cordillera
% Fig. photos of fieldwork
% Fig. Johan lineation map?

% ----------------------------------------------------------------------
\section{Numerical ice sheet model}
% ----------------------------------------------------------------------

\subsection{Overview}

The simulations presented in this thesis use Parallel Ice Sheet Model (PISM),
an open-source, finite-difference, shallow ice-sheet model
\citep{PISM-authors.2014}. The model reads bedrock topography, sea level,
geothermal heat flux and climate forcing as inputs, and computes the thermal
and dynamic state of the ice sheet, and the associated thermal and
deformational response of an idealised lithosphere. The atmospheric and oceanic
envelopes are not part of the model. However, PISM includes boundary models
that provide simple parametrisations of their effect on the ice model at
supposedly well-defined interfaces (Fig.~??).

% Fig. PISM = ice + bedrock

This section does not attempt to provide an extensive description of PISM,
which can be found in the on-line documentation \citep{PISM-authors.2014}.
Instead, it aims to highlight modelling choices made in the context of this
thesis, and give an overview of the physics involved in these choices.
Notations used and corresponding parameter choices are summarized in Table~??.

\subsection{Field equations}

The thermodynamic core of the ice sheet model relies on four elementary field
equations. Firstly, ice flow is assumed \emph{incompressible}. Hence, the
conservation of mass implies a conservation of volume, which can be expressed
in terms of the ice velocity vector, $\vec{v}$, by

\begin{equation}
    \label{eqn:incompressibility}
    \div{\vec{v}} = 0.
\end{equation}

Secondly, the \emph{balance of stresses} is expressed by the Stokes equation,
thus assuming creeping flow. In other words, ice is considered as a slow-moving
fluid whose deformation is entirely controlled by internal friction, here
expressed by the Cauchy stress tensor, $\bm\sigma$, and gravity, $\vec{g}$,

\begin{equation}
    \label{eqn:stressbalance}
    \tensdiv{\bm\sigma} + \rho\,\vec{g} = \vec{0},
\end{equation}

where $\rho$ corresponds to ice density. Thirdly, after defining the
strain-rate tensor
${\bm{\dot\epsilon}~=~\frac{1}{2}(\tensgrad{\vec{v}} +
                                  \tensgrad{\vec{v}}^{\mathrm{T}})}$,
and the deviatoric stress tensor, ${\bm{\tau} = \bm{\sigma} - p\,\bm{\delta}}$,
where $p=\frac{1}{3}\tr(\bm{\sigma})$ is the hydrostatic pressure and
$\bm{\delta}$ is the identity tensor, a \emph{constitutive law} for ice based
on laboratory experiments is used to relate these two quantities,

\begin{equation}
    \label{eqn:glenslaw}
    \bm{\dot\epsilon} = A\,\tau_e^{n-1}\,\bm{\tau}.
\end{equation}

The equivalent stress, $\tau_e$, is defined by
${\tau_e}^2 = -\mathrm{II}_{\bm{\tau}} = \frac{1}{2} \tr(\bm{\tau}^2)$,
where $\mathrm{II}_{\bm{\tau}}$ is the second invariant of the stress tensor.
The ice softness coefficient, $A$, depends on the deviation of temperature $T$
from the pressure-melting point $T_m$ through

\begin{equation}
    A = A_0\,e^\frac{-Q}{R(T-T_m)}.
\end{equation}

Letting ${\dot\epsilon_e}^2 = \frac{1}{2} \tr(\bm{\dot\epsilon}^2)$ and
$B=A^{-1/n}$, the constitutive law (\eqn{glenslaw}) can be rewritten using a
sometimes more convenient, inverted formulation,

\begin{equation}
    \bm{\tau} = B\,\dot{\epsilon}_e^{1/n-1}\,\bm{\dot\epsilon}.
\end{equation}

By analogy to Newtonian flow, an apparent viscosity, $\nu$, can then be defined
by $\bm{\tau} = \nu\,\bm{\dot\epsilon}$, thus yielding

\begin{equation}
    \label{eqn:viscosity}
    \nu = \frac{B}{2}\,\dot{\epsilon_e}^{1/n-1}.
\end{equation}

Finally, the evolution of temperature within the ice is governed by the
\emph{conservation of energy}. In PISM, the conservation of energy uses an
enthalpy formulation in order to account for thermodynamic effects associated
with internal phase changes in the glacier. This enthalpy ($H$) formulation
reads

\begin{equation}
    \label{eqn:enthalpy}
    \rho \left(\pdv{H}{t} + \vec{v} \cdot \grad{H} \right)
        = -\div{\vec{q}} + \frac{\nu\dot{\epsilon_e}^2}{4},
\end{equation}


where $\vec{q}$ represents the heat flow and
${\frac{\nu\dot{\epsilon_e}^2}{4} = \tr(\bm{\tau}\bm{\dot\epsilon})}$ is a
source term corresponding to strain heat release. In the case where ice
temperature, $T$, is below the pressure-melting point, the enthalpy can be
expressed as $H=c\,T$, while the heat flow is given by Fourier's law,
$\vec{q} = k\,\grad{T}$. Consequently, the enthalpy equation (\eqn{enthalpy})
can be rewritten using a more familiar, cold-ice, temperature formulation,

\begin{equation}
    \label{eqn:temperature}
    \frac{\partial T}{\partial t}
        + \vec{v} \cdot \vec{\mathrm{grad}}\,T
        = \frac{k}{\rho c} \Delta T
        + \frac{\nu\dot{\epsilon_e}^2}{4\rho c}.
\end{equation}

where $c$ denotes the specific heat capacity of the ice and $k$ is its thermal
conductivity. Equations~\ref{eqn:incompressibility}, \ref{eqn:stressbalance},
\ref{eqn:glenslaw}, and \ref{eqn:enthalpy} constitute the thermodynamic basis
of our model. However, their resolution in full form implies a computational
demand too high for multi-millennial, continental-scale applications, such as
the numerical modelling of the Cordilleran ice sheet through the last glacial
cycle, thus requiring shallow approximations.

\subsection{Shallow approximations}

Complete stress balance

\begin{equation}
    \left\{\begin{aligned}
        \pdv{\tau_{xx}}{x} + \pdv{\tau_{xy}}{y} + \pdv{\tau_{xz}}{z}
            &= \pdv{p}{x} \\
        \pdv{\tau_{yx}}{x} + \pdv{\tau_{yy}}{y} + \pdv{\tau_{yz}}{z}
            &= \pdv{p}{y} \\
        \pdv{\tau_{zx}}{x} + \pdv{\tau_{zy}}{y} + \pdv{\tau_{zz}}{z}
            &= \pdv{p}{z} - \rho g
    \end{aligned}\right.
\end{equation}

Shallow ice approximation

\begin{equation}
    \left\{\begin{aligned}
        \pdv{\tau_{xz}}{z} &= \pdv{p}{x} \\
        \pdv{\tau_{yz}}{z} &= \pdv{p}{y} \\
        0 &= \pdv{p}{z} - \rho g
    \end{aligned}\right.
\end{equation}


\begin{equation}
    \pdv{\vec{v}}{z} = 2A\,(\rho g)^n\,(s-z)^n\,|\grad{s}|^{n-1}\,\grad{s}
\end{equation}

Shallow shelf approximation

\begin{equation}
    \left\{\begin{aligned}
        \pdv{\tau_{xx}}{x} + \pdv{\tau_{xy}}{y} + \pdv{\tau_{xz}}{z}
            &= \pdv{p}{x} \\
        \pdv{\tau_{yx}}{x} + \pdv{\tau_{yy}}{y} + \pdv{\tau_{yz}}{z}
            &= \pdv{p}{y} \\
        \pdv{\tau_{zz}}{z} &= \pdv{p}{z} - \rho g
    \end{aligned}\right.
\end{equation}


\begin{equation}
    \left\{\begin{aligned}
        \pdv{x} \left[2\bar{\nu}H
                      \left(2\pdv{v_x}{x} + \pdv{v_y}{y}\right) \right]
            + \pdv{y} \left[\bar{\nu}H
                            \left(\pdv{v_x}{y} + \pdv{v_y}{x}\right) \right]
            + \tau_{bx} &= \rho_i gH \pdv{h}{x} \\
        \pdv{x} \left[\bar{\nu}H
                      \left(\pdv{v_x}{y} + \pdv{v_y}{x}\right) \right]
            + \pdv{y} \left[2\bar{\nu}H
                            \left(\pdv{v_x}{x} + 2\pdv{v_y}{y}\right) \right]
            + \tau_{bx} &= \rho_i gH \pdv{h}{x} \\
    \end{aligned}\right.
\end{equation}

\begin{equation}
    \bar{\nu} = \frac{\bar{B}}{2}\,\dot{\epsilon}^{\frac{1-n}{n}}
              = \frac{1}{2 \bar{A}^{\frac{1}{n}}}\,
                \dot{\epsilon}^{\frac{1-n}{n}}
\end{equation}

Basal sliding

\begin{equation}
    \bm{\tau}_b = -\tau_c \frac{\vec{v}_b}
                               {{u_{th}}^q\,|\vec{v}_b|^{1-q}}
\end{equation}

\begin{equation}
   \tau_c = c_{0} + \tan{\phi}\cdot N_{til}
\end{equation}

\newcommand{\phimin}{\phi_{\mathrm{min}}}
\newcommand{\phimax}{\phi_{\mathrm{max}}}
\newcommand{\bmin}{b_{\mathrm{min}}}
\newcommand{\bmax}{b_{\mathrm{max}}}

\begin{equation}
  \phi(x,y) =
  \begin{cases}
    \phimin, & b(x,y) \le \bmin, \\
    \phimin + (b(x,y) - \bmin) \,M, & \bmin < b(x,y) < \bmax, \\
    \phimax, & \bmax \le b(x,y).
  \end{cases}
  \label{eq:phipiecewise}
\end{equation}

\begin{equation}
N_{til} = \delta P_o \, 10^{(e_0/C_c)
          \left(1 - (W_{til}/W_{til}^{max})\right)}
\end{equation}

\subsection{Bedrock response}
\subsection{Surface mass balance}
\subsection{Atmospheric forcing}
\subsection{Numerical implementation}




% ----------------------------------------------------------------------
\section{Software tools and contributions}
% ----------------------------------------------------------------------
% Computational workflow
% Contributions to PISM
% PyPDD
% pismplotlib
% r.in.worldclim
% r.out.pism

% Fig. flow chart
% Fig. pypdd example
% Fig. pismplotlib example?

% ----------------------------------------------------------------------
\section{Results summary}
% ----------------------------------------------------------------------
% Constant-climate runs
% Effect of daily temperature variability
% Transient-climate runs

% Fig. 3km LGM quiver
% Fig. sigma distribution map
% Fig. sigma effect on Cordillera runs
% Fig. deglaciation streamplot
% Fig. cumulative ice displacement map

% ----------------------------------------------------------------------
\section{Future perpectives}
% ----------------------------------------------------------------------
% Model improvements
% Fieldwork
% Geomorphological-oriented plots

% References
\newcommand{\urlprefix}[0]{}  % remove default "URL" prefix
\bibliographystyle{copernicus}
\bibliography{refs/references.bib}

% ----------------------------------------------------------------------
\end{document}
% ----------------------------------------------------------------------
