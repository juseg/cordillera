
% ----------------------------------------------------------------------
\section{Model setup}
\label{sec:setup}
% ----------------------------------------------------------------------

%The simulations were run with PISM, a parallel ice sheet model (version stable 0.5.11). Documentation on the code can be found in several publications \citep[e.g.,][]{bueler-brown-2009,aschwanden-etal-2012} and more extensively online \citep[{\url{http://www.pism-docs.org}},][]{web:pism}.

\begin{figure}\begin{framed}
	\textbf{Technical note for Constantine}

	All my simulations use the same set of options except of a different \verb|-atmosphere_given_file| (climate forcing) and \verb|-atmosphere_delta_T_file| (temperature offset). Here comes the options that I used; I think you saw them a couple of times now. I simplified paths and filenames and remove output options for readability

	\begin{verbatim}
	mpprun pismr -boot_file boot.nc -Mx 150 -My 300
	-Mz 51 -Lz 5000 -Mbz 11 -Lbz 1000 -ys 0 -ye 10000
	-topg_to_phi 10,30,0.0,200.0
	-atmosphere given,lapse_rate,delta_T -atmosphere_given_file atm.nc
	-atmosphere_given_period 1
	-temp_lapse_rate 6 -atmosphere_lapse_rate_file atm.nc
	-atmosphere_delta_T_file step-cool08.nc
	-surface pdd -pdd_annualize
	-ocean constant,delta_SL -ocean_delta_SL_file step-low120.nc
	-ssa_sliding
	-config_override config.nc
	\end{verbatim}

	And here comes the relevant contents of \verb|config.nc|:

	\begin{verbatim}
	netcdf config \{
	variables:
	  byte pism_overrides ;
	    pism_overrides:bed_deformation_model = "lc" ;
	    pism_overrides:do_thickness_calving = "true" ;
	    pism_overrides:calving_at_thickness = 200. ;
	    pism_overrides:calving_front_stress_boundary_condition = "yes" ;
	    pism_overrides:part_grid = "yes" ;
	    pism_overrides:part_redist = "yes" ;
	    pism_overrides:kill_icebergs = "yes" ;
	    pism_overrides:bootstrapping_geothermal_flux_value_no_var = 0.07 ;
	    pism_overrides:pdd_factor_snow = 0.003 ;
	    pism_overrides:pdd_factor_ice = 0.008 ;
	    pism_overrides:pdd_refreeze = 0.6 ;
	    pism_overrides:pdd_std_dev = 5 ;
	\}
 
	\end{verbatim}

\end{framed}\end{figure}

\subsection{Surface mass-balance}

\begin{table}[t]
	\caption{Values of the positive degree-day model parameters.}
	\label{tab:pdd}
	\vskip4mm
	\centering
	\begin{tabular}{ll}
		\tophline
		Parameter& Value\\
		\middlehline
		degree-day factor for snow & 3\,\unit{mm\,K^{-1}\,day^{-1}}\\
		degree-day factor for ice & 8\,\unit{mm\,K^{-1}\,day^{-1}}\\
		standard deviation of temperatures & 5\,K\\
		refreezing faction & 0.6 \\
		\bottomhline
	\end{tabular}
\end{table}

Monthly temperatures and precipitation rates are converted to surface accumulation and ablation using a temperature-index (positive degree-day) model\needref. Accumulation is computed as the amount of precipitation that falls at times when temperature is below freezing \todo{Check PISM doc}. Ablation is a transfer function of the number of positive degree-day, defined as the sum of mean daily temperatures through the year. Positive degree-day are computed by the \citet{calov-greve-2011} integrand to account for day-to-day variability which is not represented in the monthly climate forcing. The ablation model use a different coefficient for snow and ice and accounts for refreezing. Model parameters are explicited in table~\ref{tab:pdd}

Although a positive degree-day model is a very crude approximation of processes occurring at the glacier surface, we will show that it captures reasonable regional patterns of accumulation and ablation when using accurate climate data.

\todo[inline]{
	\textbf{Include the \citet{calov-greve-2011} integrand formula?}

	The number of positive degree-days, defined as the integrand of positive temperatures over time, is computed annually using a formula derived by \citet{calov-greve-2011} that accounts for day-to-day variability of temperature by assuming a normal distribution of variance $\sigma=5\degree C$ along a central (input) value $T$:

	\begin{equation}
		\mathrm{PDD} = \int_{t_0}^{t_1} dt \left[
			\frac{\sigma}{\sqrt{2\pi}}
			\exp\left({-\frac{T(t)^2}{2\sigma^2}}\right)
			+\frac{T(t)}{2}
			\mathrm{erfc} \left(-\frac{T(t)}{\sqrt{2}\sigma}\right)
		\right]
	\end{equation}

Where $[t_0; t_1]$ is one year and $\mathrm{erfc}$ is the complementary error function.}

\subsection{Ice dynamics}

Ice flow velocities are computed by a heuristic where the Shallow Shelf Approximation (SSA) is used as a ``sliding law'' to a polythermal Shallow Ice Approximation (SIA) \citep{bueler-brown-2009}. 

\todo[inline]{
	\textbf{Include SSA+SIA \citet{bueler-brown-2009} formula}

	Depth-averaged velocities $\vec{v}$ are computed as a weighted sum of SIA velocities $\vec{v_{\mathrm{SIA}}}$ and SSA velocities $\vec{v_{\mathrm{SSA}}}$ by

	\begin{equation}
		\vec{v} = f(|\vec{v_{\mathrm{SSA}}}|)\vec{v_{\mathrm{SIA}}}
	  + (1-f(|\vec{v_{\mathrm{SSA}}}|))\vec{v_{\mathrm{SSA}}},
	\end{equation}

	with

	\begin{equation}
		f(|\vec{v_{\mathrm{SSA}}}|) = 1
		- \frac{2}{\pi}\arctan{\frac{|\vec{v_{\mathrm{SSA}}}|^2}{100^2}}.
	\end{equation}
}

SSA velocities are determined by a a pseudo-plastic sliding law where the yield stress depends on the availability of basal water and a prescibed till friction angle$\phi$. We apply lower friction angles at low elevation to mimick the more slippery beds associated to the presence of marine sediments:

\begin{equation}
	\phi = \left\{\begin{array}{llc}
		10\,\unit{\degree C} & \mathrm{for} &               z<  0\,\unit{m} \\
		z/10 + 10Â°           & \mathrm{for} &   0\,\unit{m}<z<200\,\unit{m} \\
		30\,\unit{\degree C} & \mathrm{for} & 200\,\unit{m}<z               \\
	\end{array}\right.
\end{equation}

%\subsection{Glacier bed interface}
%
%The ice-sheet bed topography responds to the ice-loads following a regional isostasy model with flexure and relaxation.
%
%Geothermal heat flux is prescribed to 70\,\unit{W\,m^{-2}}
%
\subsection{Simulation design and numerical implementation}

In this study we model glacial inception and growth of the Cordilleran ice sheet to a state approaching its last glacial maximum. We mimick glacial conditions by applying constant temperature offsets homogeneously over the entire domain. Each simulation starts from ice-free conditions and is run for 10,000 years, a time interval which we think to be representative of the rapid build-up of the last Cordilleran Ice Sheet from nearly ice-free condition to last glacial maximum extent \needref.

Our computational domain consists of 10~km-resolution, 150 by 300 points horizontal grid. Equations that involve a vertical coordinate are solved on 51 irregularly-spaced layers in ice and 11 regularly spaced layers in rock\todo{Check PISM doc}. The simulations were run in parallel on 32 cores, on NSC's supercomputer triolith\needref.

