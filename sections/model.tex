
% ----------------------------------------------------------------------
\section{Model setup}
\label{sec:setup}
% ----------------------------------------------------------------------

We use PISM, a parallel ice sheet model (version stable 0.5.11). Documentation on the code can be found in several publications \citep[e.g.,][]{bueler-brown-2009,winkelmann-etal-2011,aschwanden-etal-2012} and more extensively online \citep[{\url{http://www.pism-docs.org}},][]{web:pism}.

\subsection{Surface mass-balance}

\begin{table}[t]
	\caption{Values of the positive degree-day model parameters.}
	\label{tab:pdd}
	\vskip4mm
	\centering
	\begin{tabular}{ll}
		\tophline
		Parameter& Value\\
		\middlehline
		degree-day factor for snow & 3\,\unit{mm\,K^{-1}\,day^{-1}}\\
		degree-day factor for ice & 8\,\unit{mm\,K^{-1}\,day^{-1}}\\
		standard deviation of temperatures & 5\,K\\
		refreezing faction & 0.6 \\
		\bottomhline
	\end{tabular}
\end{table}

Monthly temperatures and precipitation rates are converted to surface accumulation and ablation using a temperature-index (positive degree-day) model. Accumulation is computed as the amount of precipitation that falls when temperature is below freezing.\askconstantine{Is this true? What is the current threshold in stable 0.5?} Ablation is computed from the number of positive degree-days, defined as the integrand of temperatures above 0\,\degree\,C in one year. Positive degree-days are computed by the \citet{calov-greve-2011} formula to account for day-to-day variability unrepresented in the monthly climate forcing. The ablation model use different degree-day factors for snow and ice and accounts for refreezing. Complete description of the ablation model is available in PISM documentation \citep[{\url{http://www.pism-docs.org}},][]{web:pism} and model parameters are explicited in table~\ref{tab:pdd}.

\todo[inline]{
	\textbf{Include the \citet{calov-greve-2011} integrand formula?}

	The number of positive degree-days, defined as the integrand of positive temperatures over time, is computed annually using a formula derived by \citet{calov-greve-2011} that accounts for day-to-day variability of temperature by assuming a normal distribution of variance $\sigma=5\degree C$ along a central (input) value $T$:

	\begin{equation}
		\mathrm{PDD} = \int_{t_0}^{t_1} dt \left[
			\frac{\sigma}{\sqrt{2\pi}}
			\exp\left({-\frac{T(t)^2}{2\sigma^2}}\right)
			+\frac{T(t)}{2}
			\mathrm{erfc} \left(-\frac{T(t)}{\sqrt{2}\sigma}\right)
		\right]
	\end{equation}

Where $[t_0; t_1]$ is one year and $\mathrm{erfc}$ is the complementary error function.}

A positive degree-day model is a very crude approximation of physical processes occurring at a glacier's surface. Yet we believe that it captures regional patterns of accumulation and ablation resonable enough for our study if accurate climate data is used, as we will show further.\todo{Is this paragraph really needed?}

\subsection{Ice thermodynamics}

Ice flow velocities are computed by a heuristic where the Shallow Shelf Approximation (SSA) is used as a ``sliding law'' to a polythermal Shallow Ice Approximation (SIA) \citep{bueler-brown-2009}. 

\todo[inline]{
	\textbf{Include SSA+SIA \citet{bueler-brown-2009} formula?}

	Depth-averaged velocities $\vec{v}$ are computed as a weighted sum of SIA velocities $\vec{v_{\mathrm{SIA}}}$ and SSA velocities $\vec{v_{\mathrm{SSA}}}$ by

	\begin{equation}
		\vec{v} = f(|\vec{v_{\mathrm{SSA}}}|)\vec{v_{\mathrm{SIA}}}
	  + (1-f(|\vec{v_{\mathrm{SSA}}}|))\vec{v_{\mathrm{SSA}}},
	\end{equation}

	with

	\begin{equation}
		f(|\vec{v_{\mathrm{SSA}}}|) = 1
		- \frac{2}{\pi}\arctan{\frac{|\vec{v_{\mathrm{SSA}}}|^2}{100^2}}.
	\end{equation}
}

SIA and SSA velocities are computed by finite difference methods on a 10km-resolution horizontal grid of 300 by 150 points. SIA velocities follow temperature-dependant creep. Temperatures are derived from an enthalpy formulation \citep{aschwanden-etal-2012} and computed in three dimensions on 51 irregularly spaced layers in ice and 11 regularly spaced layers in rock. An homogeneous geothermal heat flux of 70\,\unit{W\,m^{-2}} is provided as lower boundary condition to the thermal model, and surface air temperature from the various climate forcing is used as upper boundary condition.

SSA velocities are determined by a a pseudo-plastic sliding law where the yield stress depends on the availability of basal water and a prescibed till friction angle$\phi$. We apply lower friction angles at low elevation to mimick the more slippery beds associated to the presence of marine sediments:

\begin{equation}
	\phi = \left\{\begin{array}{llc}
		10\,\unit{\degree C} & \mathrm{for} &               z<  0\,\unit{m} \\
		z/10 + 10Â°           & \mathrm{for} &   0\,\unit{m}<z<200\,\unit{m} \\
		30\,\unit{\degree C} & \mathrm{for} & 200\,\unit{m}<z               \\
	\end{array}\right.
\end{equation}

The glacier bed topography responds to the ice load following a regional isostasy model with flexure and relaxation \citep{lingle-clark-1985}\todo{check ref.}.

\subsection{Simulation design and numerical implementation}

In this study we model glacial inception and growth of the Cordilleran ice sheet to a state approaching its last glacial maximum. We mimick glacial conditions by applying constant temperature offsets homogeneously over the entire domain. Each simulation starts from ice-free conditions and is run for 10,000 years, a time interval which we think to be representative of the rapid build-up of the last Cordilleran Ice Sheet from nearly ice-free condition to last glacial maximum extent \needref.

Our computational domain consists of 10~km-resolution, 150 by 300 points horizontal grid. Equations that involve a vertical coordinate are solved on 51 irregularly-spaced layers in ice and 11 regularly spaced layers in rock\todo{Check PISM doc}. The simulations were run in parallel on 32 cores, on NSC's supercomputer triolith\needref.

